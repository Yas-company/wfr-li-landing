---
import Layout from '~/layouts/Layout.astro';
import Hero from '~/sections/Hero.astro';
import About from '~/sections/About.astro';
import Features from '~/sections/Features.astro';
import HowItWorks from '~/sections/HowItWorks.astro';
import SupplierBenefits from '~/sections/SupplierBenefits.astro';
import Faq from '~/sections/Faq.astro';
---

<Layout 
  title="وفر لي - منصتك لتوفير كل احتياجاتك"
  description="منصة رائدة تربط المستهلكين وتجار التجزئة بالموردين المحليين. وفر الوقت والمال على مشترياتك مع أسعار تنافسية والتوصيل مباشرة من المورد."
>
  <main>
    <!-- Hero Section -->
    <Hero />

    <!-- Stats Section -->
    <section class="py-16 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-2 md:grid-cols-3 gap-8" x-data="{
           visible: false,
           stats: {
             suppliers: { current: 0, target: 0, suffix: '+' },
             satisfaction: { current: 0, target: 0, suffix: '%' },
             support: { current: 0, target: 24, suffix: '/7' }
           },
           
           initStats() {
             // Read values from data-num attributes and update targets
             const elements = this.$el.querySelectorAll('[data-num]');
             elements.forEach(el => {
               const key = el.dataset.key;
               const num = parseInt(el.dataset.num);
               const suffix = el.dataset.suffix || '';
               if (key && this.stats[key]) {
                 this.stats[key].target = num;
                 this.stats[key].suffix = suffix;
               }
             });
           },
           
           animateCounter(statKey) {
             const stat = this.stats[statKey];
             const duration = 2000;
             const startTime = performance.now();
             
             const animate = (currentTime) => {
               const elapsed = currentTime - startTime;
               const progress = Math.min(elapsed / duration, 1);
               
               // Easing function for smooth animation
               const easeOutCubic = 1 - Math.pow(1 - progress, 3);
               stat.current = Math.floor(stat.target * easeOutCubic);
               
               if (progress < 1) {
                 requestAnimationFrame(animate);
               } else {
                 stat.current = stat.target;
               }
             };
             
             requestAnimationFrame(animate);
           },
           
           animateStats() {
             this.initStats();
             // Stagger animations for better visual effect
             Object.keys(this.stats).forEach((key, index) => {
               setTimeout(() => this.animateCounter(key), index * 200);
             });
           }
         }" x-intersect="visible = true; setTimeout(() => animateStats(), 300)">
          
          <div class="text-center" x-show="visible" x-transition.opacity.duration.800ms>
            <div class="text-3xl md:text-4xl font-bold text-[var(--color-primary)] mb-2" 
                 data-num="0" 
                 data-suffix="+" 
                 data-key="suppliers"
                 x-text="stats.suppliers.current + stats.suppliers.suffix">
              0+
            </div>
            <p class="text-gray-700">مورد معتمد</p>
          </div>
          
          <div class="text-center" x-show="visible" x-transition.opacity.duration.800ms>
            <div class="text-3xl md:text-4xl font-bold text-[var(--color-primary)] mb-2" 
                 data-num="0" 
                 data-suffix="%" 
                 data-key="satisfaction"
                 x-text="stats.satisfaction.current + stats.satisfaction.suffix">
              0%
            </div>
            <p class="text-gray-700">رضا العملاء</p>
          </div>
          
          <div class="text-center col-span-2 md:col-span-1" x-show="visible" x-transition.opacity.duration.800ms>
            <div class="text-3xl md:text-4xl font-bold text-[var(--color-primary)] mb-2" 
                 data-num="24" 
                 data-suffix="/7" 
                 data-key="support"
                 x-text="stats.support.current + stats.support.suffix">
              24/7
            </div>
            <p class="text-gray-700">دعم فني</p>
          </div>
          
        </div>
      </div>
    </section>

    <!-- About Section -->
    <About />

    <!-- Features Section -->
    <Features />

    <!-- How It Works Section -->
    <HowItWorks />

    <!-- Supplier Benefits Section -->
    <SupplierBenefits />

    <!-- FAQ Section -->
    <Faq />

    <!-- CTA Section -->
    <section id="cta" class="py-20 bg-primary">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div>
          <h2 class="text-3xl md:text-4xl font-bold !text-white mb-6">
            ابدأ رحلتك مع وفر لي اليوم
          </h2>
          <p class="text-xl !text-white mb-8">
            انضم إلى شبكة الموردين والمشترين على منصة وفر لي
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <button 
              onclick="document.getElementById('contact').scrollIntoView({behavior: 'smooth'})"
              class="bg-white text-primary text-lg font-semibold px-8 py-3 rounded-full flex items-center justify-center gap-2 group">
              <span>سجل اهتمامك الآن</span>
              <i class="ri-arrow-left-line"></i>
            </button>
            <button 
              onclick="document.getElementById('contact').scrollIntoView({behavior: 'smooth'})"
              class="border-2 border-white text-white text-lg font-semibold px-8 py-3 rounded-full">
              تحدث مع فريق المبيعات
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-20 bg-gray-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid lg:grid-cols-2 gap-12">
          <!-- Contact Info -->
          <div>
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">
              تواصل معنا
            </h2>
            <p class="text-lg text-gray-700 mb-8">
              نحن هنا لمساعدتك. تواصل معنا عبر أي من الطرق التالية
            </p>
            
            <div class="space-y-6">
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center border border-gray-200">
                  <i class="ri-phone-line text-[var(--color-primary)] text-xl"></i>
                </div>
                <div>
                  <h3 class="font-medium text-gray-900">الهاتف</h3>
                  <a href="tel:+966506564275" class="text-gray-700 hover:text-[var(--color-primary)] transition-colors" dir="ltr">+966 50 656 4275</a>
                </div>
              </div>
              
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center border border-gray-200">
                  <i class="ri-mail-line text-[var(--color-primary)] text-xl"></i>
                </div>
                <div>
                  <h3 class="font-medium text-gray-900">البريد الإلكتروني</h3>
                  <a href="mailto:info@wfr.li" class="text-gray-700 hover:text-[var(--color-primary)] transition-colors">info@wfr.li</a>
                </div>
              </div>
              
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center border border-gray-200">
                  <i class="ri-map-pin-line text-[var(--color-primary)] text-xl"></i>
                </div>
                <div>
                  <h3 class="font-medium text-gray-900">العنوان</h3>
                  <p class="text-gray-700">مكة المكرمة، المملكة العربية السعودية</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Contact Form -->
          <div class="bg-white rounded-2xl p-8 shadow-lg" x-data="{ formData: { name: '', email: '', message: '' } }">
            <h3 class="text-2xl font-bold text-gray-900 mb-6">
              أرسل لنا رسالة
            </h3>
            
            <form class="space-y-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">الاسم</label>
                <input type="text" x-model="formData.name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent" placeholder="أدخل اسمك">
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">البريد الإلكتروني</label>
                <input type="email" x-model="formData.email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent" placeholder="أدخل بريدك الإلكتروني">
              </div>
              
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">الرسالة</label>
                <textarea x-model="formData.message" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent" placeholder="اكتب رسالتك هنا"></textarea>
              </div>
              
              <button type="submit" class="w-full bg-[var(--color-primary)] text-white px-6 py-3 rounded-lg font-medium">
                إرسال الرسالة
              </button>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Custom Styles -->
  <style>
    :root {
      --color-primary: oklch(0.596 0.101 199);    /* #009196 */
      --color-secondary: oklch(0.786 0.164 71.7);  /* #F9A51A */
      --color-text: oklch(0.596 0 none);     /* #7F7F7F */
    }

    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }

    /* Custom animations removed */

    /* Alpine.js cloak */
    [x-cloak] {
      display: none !important;
    }

    /* Ensure text visibility */
    body {
      color: #374151; /* gray-700 */
    }

    h1, h2, h3, h4, h5, h6 {
      color: #111827; /* gray-900 */
    }

    p {
      color: #374151; /* gray-700 */
    }
  </style>
</Layout>