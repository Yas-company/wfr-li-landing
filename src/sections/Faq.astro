---
// src/sections/Faq.astro
---

<style>
  /* Enhanced FAQ Animations */
  .faq-item {
    transform-style: preserve-3d;
    perspective: 1000px;
  }
  
  .faq-item:hover {
    transform: translateY(-2px) rotateX(2deg);
  }
  
  .faq-content {
    backface-visibility: hidden;
  }
  
  /* Pulse animation for active state */
  @keyframes pulse-ring {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: scale(1.1);
      opacity: 0;
    }
  }
  
  .faq-active::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: inherit;
    background: linear-gradient(45deg, oklch(var(--color-primary)), oklch(var(--color-secondary)));
    z-index: -1;
    animation: pulse-ring 2s infinite;
  }
  
  /* Smooth height transition */
  .faq-answer {
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Icon rotation with spring effect */
  .faq-icon {
    transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }
  
  /* Staggered content animation */
  .faq-content > * {
    transition: all 0.3s ease-out;
  }
  
  .faq-content.entering > * {
    animation: slideInContent 0.6s ease-out forwards;
  }
  
  @keyframes slideInContent {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Enhanced hover effects */
  .faq-button:hover {
    background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(0,0,0,0.02));
  }
  
  /* Removed ring animation for cleaner active state */
</style>
<section class="py-20 bg-gray-50" x-data="{
  openFaq: null,
  isVisible: false,
  faqs: [
    {
      id: 1,
      icon: 'ri-play-circle-line',
      question: 'كيف أبدأ استخدام وفر لي؟',
      answer: 'التسجيل في وفر لي سهل وسريع. ما عليك سوى إنشاء حساب، وبعدها يمكنك مباشرة البدء في طلب المنتجات من بائعينا المعتمدين.',
      time: 'أقل من 5 دقائق'
    },
    {
      id: 2,
      icon: 'ri-map-pin-line',
      question: 'هل الخدمة متاحة في كل المدن؟',
      answer: 'حالياً، نقدم خدماتنا في المدن الرئيسية في المملكة العربية السعودية، ونعمل على التوسع لتغطية المزيد من المناطق قريباً.',
      note: 'التوسع مستمر لمدن جديدة'
    },
    {
      id: 3,
      icon: 'ri-money-dollar-circle-line',
      question: 'هل يوجد رسوم على التسجيل؟',
      answer: 'التسجيل في وفر لي مجاني تماماً. نحن نحصل على عمولة بسيطة فقط على الطلبات المكتملة.',
      note: 'مجاني 100% - لا رسوم خفية'
    },
    {
      id: 4,
      icon: 'ri-customer-service-2-line',
      question: 'كيف أتواصل مع الدعم الفني؟',
      answer: 'يمكنك التواصل مع فريق الدعم الفني على مدار الساعة عبر الواتساب، البريد الإلكتروني، أو من خلال نموذج الاتصال في موقعنا.',
      channels: ['واتساب', 'إيميل']
    },
    {
      id: 5,
      icon: 'ri-shopping-basket-line',
      question: 'ما هي أنواع المنتجات المتوفرة؟',
      answer: 'نوفر مجموعة واسعة من المنتجات تشمل الخضروات والفواكه، اللحوم والأسماك، الألبان ومنتجاتها، البقوليات والحبوب، والمنتجات المعلبة والمجمدة.',
      categories: ['خضروات وفواكه', 'لحوم وأسماك', 'ألبان ومنتجاتها', 'منتجات معلبة']
    },
    {
      id: 6,
      icon: 'ri-shield-check-line',
      question: 'كيف يتم ضمان جودة المنتجات؟',
      answer: 'نتعامل فقط مع بائعين معتمدين ومحليين موثوقين.',
      guarantees: ['بائعين معتمدين']
    },
    {
      id: 7,
      icon: 'ri-truck-line',
      question: 'من المسؤول عن توصيل الطلبات؟',
      answer: 'يتولى البائعون مسؤولية توصيل الطلبات مباشرة إلى عملائهم. منصة وفر لي تعمل كوسيط لربط المشترين بالبائعين، وليست مسؤولة عن عملية التوصيل أو الشحن.',
      note: 'كل بائع يحدد طريقة التوصيل الخاصة به، بما في ذلك الأسعار والمواعيد ومناطق التغطية.',
      features: ['التوصيل من البائع', 'تواصل مباشر']
    }
  ],
  toggleFaq(id) {
    this.openFaq = this.openFaq === id ? null : id;
  }
}" x-init="
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        isVisible = true;
      }
    });
  }, { threshold: 0.1 });
  observer.observe($el);
">
  <div class="container mx-auto px-4">
    <!-- Header -->
    <div class="text-center mb-16">
      <div class="inline-flex items-center justify-center w-16 h-16 rounded-full mb-6" style="background-color: oklch(var(--color-primary) / 0.1);">
        <i class="ri-question-answer-line text-2xl" style="color: oklch(var(--color-primary));"></i>
      </div>
      
      <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
        الأسئلة <span style="color: oklch(var(--color-primary));">الشائعة</span>
      </h2>
      
      <p class="text-lg text-gray-600 max-w-2xl mx-auto mb-6">
        إجابات شاملة على أكثر الأسئلة شيوعاً حول منصة وفر لي
      </p>
      
      <p class="text-gray-600">
        لم تجد إجابة لسؤالك؟ 
        <a href="#contact" class="font-medium underline" style="color: oklch(var(--color-primary));">تواصل معنا مباشرة</a>
      </p>
      
      <!-- Info badges -->
      <div class="flex flex-wrap justify-center gap-4 mt-8">
        <div class="bg-white border border-gray-200 rounded-full px-4 py-2 shadow-sm">
          <div class="flex items-center gap-2">
            <i class="ri-time-line" style="color: oklch(var(--color-primary));"></i>
            <span class="text-sm font-medium text-gray-700">إجابة فورية</span>
          </div>
        </div>
        <div class="bg-white border border-gray-200 rounded-full px-4 py-2 shadow-sm">
          <div class="flex items-center gap-2">
            <i class="ri-customer-service-line" style="color: oklch(var(--color-primary));"></i>
            <span class="text-sm font-medium text-gray-700">دعم على مدار الساعة</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- FAQ Items -->
    <div class="max-w-4xl mx-auto space-y-4">
      <template x-for="(faq, index) in faqs" :key="faq.id">
         <div 
           class="faq-item bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg hover:-translate-y-1 transition-all duration-500 transform relative"
           x-show="isVisible"
           x-transition:enter="transition ease-out duration-700"
           x-transition:enter-start="opacity-0 translate-y-8 scale-95"
           x-transition:enter-end="opacity-1 translate-y-0 scale-100"
           :style="'transition-delay: ' + (index * 100 + 200) + 'ms'"
           :class="{
             'shadow-xl': openFaq === faq.id
           }"
           style="--ring-color: oklch(var(--color-primary));"
         >
          <!-- Question -->
           <button
             @click="toggleFaq(faq.id)"
             class="faq-button w-full px-6 py-6 text-right flex items-center justify-between hover:bg-gray-50 transition-all duration-300 group relative overflow-hidden"
             :class="openFaq === faq.id ? 'bg-gray-50' : ''"
           >
             <!-- Ripple effect on click -->
             <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-active:translate-x-full transition-transform duration-500 ease-out"></div>
            <div class="flex items-center gap-4">
              <div 
                class="w-12 h-12 rounded-xl flex items-center justify-center transition-all duration-300 group-hover:scale-105"
                style="background-color: oklch(var(--color-primary) / 0.1);"
                :class="openFaq === faq.id ? 'scale-110 shadow-lg' : ''"
                :style="openFaq === faq.id ? 'background-color: oklch(var(--color-primary) / 0.2);' : ''"
              >
                <i 
                   :class="faq.icon" 
                   class="faq-icon text-lg transition-all duration-300"
                   style="color: oklch(var(--color-primary));"
                   :class="openFaq === faq.id ? 'scale-110 rotate-12' : ''"
                 ></i>
              </div>
              <span 
                class="text-lg font-semibold text-gray-900 transition-colors duration-300 group-hover:text-gray-700" 
                x-text="faq.question"
                :class="openFaq === faq.id ? 'text-gray-800' : ''"
              ></span>
            </div>
            <div class="flex items-center">
              <div class="w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 group-hover:bg-gray-100" :class="openFaq === faq.id ? 'bg-gray-100 rotate-180' : ''">
                <i 
                  class="ri-arrow-down-s-line text-xl transition-all duration-300 ease-out" 
                  style="color: oklch(var(--color-primary));" 
                  :class="openFaq === faq.id ? 'rotate-180 scale-110' : 'group-hover:scale-105'"
                ></i>
              </div>
            </div>
          </button>
          
          <!-- Answer -->
          <div 
             x-show="openFaq === faq.id" 
             x-transition:enter="transition ease-out duration-500" 
             x-transition:enter-start="opacity-0 max-h-0 transform scale-y-0" 
             x-transition:enter-end="opacity-1 max-h-screen transform scale-y-100" 
             x-transition:leave="transition ease-in duration-300" 
             x-transition:leave-start="opacity-1 max-h-screen transform scale-y-100" 
             x-transition:leave-end="opacity-0 max-h-0 transform scale-y-0" 
             class="faq-answer overflow-hidden origin-top"
             style="transform-origin: top;"
           >
            <div 
               class="faq-content px-6 pb-6 transform transition-all duration-500 ease-out"
               x-transition:enter="transition ease-out duration-600 delay-100"
               x-transition:enter-start="opacity-0 translate-y-4"
               x-transition:enter-end="opacity-1 translate-y-0"
               :class="openFaq === faq.id ? 'entering' : ''"
             >
               <div class="pt-4 border-t border-gray-100 relative">
                <!-- Animated border -->
                <div 
                  class="absolute top-0 left-0 h-0.5 bg-gradient-to-r from-transparent via-current to-transparent transition-all duration-700 ease-out"
                  style="color: oklch(var(--color-primary));"
                  :class="openFaq === faq.id ? 'w-full opacity-100' : 'w-0 opacity-0'"
                ></div>
                <p class="text-gray-700 leading-relaxed mb-4" x-text="faq.answer"></p>
                
                <!-- Time info -->
                <div x-show="faq.time" class="flex items-center gap-2 text-sm mb-3" style="color: oklch(var(--color-primary));">
                  <i class="ri-time-line"></i>
                  <span x-text="'وقت التسجيل: ' + faq.time"></span>
                </div>
                
                <!-- Note -->
                <div x-show="faq.note" class="flex items-center gap-2 text-sm mb-3" style="color: oklch(var(--color-secondary));">
                  <i class="ri-information-line"></i>
                  <span x-text="faq.note"></span>
                </div>
                
                <!-- Channels -->
                <div x-show="faq.channels" class="flex flex-wrap gap-2 mb-3">
                  <template x-for="channel in faq.channels || []">
                    <div class="bg-white border rounded-full px-3 py-1 text-sm" style="border-color: oklch(var(--color-primary)); color: oklch(var(--color-primary));">
                      <span x-text="channel"></span>
                    </div>
                  </template>
                </div>
                
                <!-- Categories -->
                <div x-show="faq.categories" class="grid grid-cols-2 gap-2 mb-3">
                  <template x-for="category in faq.categories || []">
                    <div class="flex items-center gap-2 text-sm" style="color: oklch(var(--color-primary));">
                      <i class="ri-check-line"></i>
                      <span x-text="category"></span>
                    </div>
                  </template>
                </div>
                
                <!-- Guarantees -->
                <div x-show="faq.guarantees" class="flex flex-wrap gap-2 mb-3">
                  <template x-for="guarantee in faq.guarantees || []">
                    <div class="bg-white border rounded-full px-3 py-1 text-sm" style="border-color: oklch(var(--color-secondary)); color: oklch(var(--color-secondary));">
                      <span x-text="guarantee"></span>
                    </div>
                  </template>
                </div>
                
                <!-- Features -->
                <div x-show="faq.features" class="flex flex-wrap gap-2">
                  <template x-for="feature in faq.features || []">
                    <div class="bg-white border rounded-full px-3 py-1 text-sm" style="border-color: oklch(var(--color-primary)); color: oklch(var(--color-primary));">
                      <span x-text="feature"></span>
                    </div>
                  </template>
                </div>
                
                <!-- Special note for delivery -->
                <div x-show="faq.id === 7" class="bg-gray-50 border border-gray-200 p-4 rounded-lg mt-4">
                  <div class="flex items-start gap-3">
                    <i class="ri-information-line text-lg mt-1" style="color: oklch(var(--color-primary));"></i>
                    <div>
                      <h4 class="font-semibold text-gray-900 mb-2">ملاحظة مهمة</h4>
                      <p class="text-gray-700 text-sm" x-text="faq.note"></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </template>
    </div>
  </div>
</section>